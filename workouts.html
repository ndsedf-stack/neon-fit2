<!DOCTYPE html>
<html lang="fr" class="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, maximum-scale=1.0, user-scalable=no" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <title>NEON FIT // OPÉRATIONS</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Chakra+Petch:wght@400;500;600;700;800;900&family=Inter:wght@400;600;700;800;900&display=swap" rel="stylesheet">
  <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
  <script src="program-data-v2.js?v=1764354000"></script>
  <script src="app-v2.js?v=1764354000"></script>
  
  <style>
    :root { 
      --void: #020408;
      --cyan: #22d3ee;
      --purple: #c084fc;
    }
    
    * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }
    
    body { 
      background-color: var(--void);
      font-family: 'Inter', sans-serif;
      color: #f8fafc;
      min-height: 100dvh;
      padding-bottom: calc(20px + env(safe-area-inset-bottom));
    }
    
    .font-hud { font-family: 'Chakra Petch', sans-serif; }
    
    /* ========== GRAIN OVERLAY ========== */
    .grain-overlay {
      position: fixed;
      inset: 0;
      background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='3'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
      opacity: 0.025;
      pointer-events: none;
      z-index: 999;
    }
    
    /* ========== ANIMATIONS ========== */
    @keyframes subtlePulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.7; }
    }
    
    @keyframes glowPulse {
      0%, 100% { box-shadow: 0 0 15px rgba(34, 211, 238, 0.3); }
      50% { box-shadow: 0 0 25px rgba(34, 211, 238, 0.5); }
    }
    
    @keyframes slideUp {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    @keyframes shimmer {
      0% { background-position: -200% 0; }
      100% { background-position: 200% 0; }
    }
    
    @keyframes float {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-3px); }
    }
    
    .animate-slide-up {
      animation: slideUp 0.6s cubic-bezier(0.16, 1, 0.3, 1) forwards;
    }
    
    /* ========== HEADER ========== */
    .header-bar {
      padding: max(14px, env(safe-area-inset-top)) 20px 12px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .net-status {
      display: flex;
      align-items: center;
      gap: 6px;
    }
    
    .net-dot {
      width: 6px;
      height: 6px;
      background: #22c55e;
      border-radius: 50%;
      box-shadow: 0 0 8px #22c55e;
      animation: subtlePulse 2s ease-in-out infinite;
    }
    
    /* ========== TIMELINE ========== */
    .timeline-scroll {
      display: flex;
      overflow-x: auto;
      scroll-snap-type: x mandatory;
      padding: 12px 20px;
      gap: 10px;
      scrollbar-width: none;
      -webkit-overflow-scrolling: touch;
    }
    
    .timeline-scroll::-webkit-scrollbar { display: none; }
    
    .week-chip {
      scroll-snap-align: center;
      flex: 0 0 auto;
      width: 50px;
      height: 54px;
      background: linear-gradient(145deg, rgba(255,255,255,0.04) 0%, rgba(255,255,255,0.01) 100%);
      border: 1px solid rgba(255,255,255,0.08);
      border-radius: 12px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
      position: relative;
    }
    
    .week-chip:active { transform: scale(0.92); }
    
    .week-chip.active {
      background: linear-gradient(145deg, rgba(34, 211, 238, 0.15) 0%, rgba(34, 211, 238, 0.05) 100%);
      border-color: var(--cyan);
      animation: glowPulse 2s ease-in-out infinite;
    }
    
    .week-chip.active .week-num {
      color: var(--cyan);
      text-shadow: 0 0 10px var(--cyan);
    }
    
    .week-chip.active::after {
      content: '';
      position: absolute;
      bottom: 6px;
      width: 4px;
      height: 4px;
      background: var(--cyan);
      border-radius: 50%;
      box-shadow: 0 0 6px var(--cyan);
    }
    
    .week-chip.deload { border-color: rgba(34, 197, 94, 0.4); }
    .week-chip.deload .week-label, .week-chip.deload .week-num { color: #22c55e; }
    .week-chip.deload.active { 
      background: linear-gradient(145deg, rgba(34, 197, 94, 0.15) 0%, rgba(34, 197, 94, 0.05) 100%);
      border-color: #22c55e;
      box-shadow: 0 0 20px rgba(34, 197, 94, 0.3);
    }
    
    .week-chip.peak { border-color: rgba(168, 85, 247, 0.4); }
    .week-chip.peak .week-label, .week-chip.peak .week-num { color: #a855f7; }
    .week-chip.peak.active {
      background: linear-gradient(145deg, rgba(168, 85, 247, 0.15) 0%, rgba(168, 85, 247, 0.05) 100%);
      border-color: #a855f7;
      box-shadow: 0 0 20px rgba(168, 85, 247, 0.3);
    }
    
    .week-label { font-size: 7px; font-weight: 700; color: #64748b; text-transform: uppercase; }
    .week-num { font-family: 'Chakra Petch', sans-serif; font-size: 18px; font-weight: 800; color: #e2e8f0; }
    
    /* ========== BLOCK HEADER ========== */
    .block-header {
      padding: 16px 20px;
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
    }
    
    .block-title {
      font-family: 'Chakra Petch', sans-serif;
      font-size: 24px;
      font-weight: 900;
      color: #fff;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    
    .block-meta {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-top: 4px;
    }
    
    .block-meta::before {
      content: '//';
      color: var(--cyan);
      font-weight: 700;
    }
    
    .block-meta-text {
      font-size: 10px;
      font-weight: 600;
      color: var(--cyan);
      text-transform: uppercase;
      letter-spacing: 0.12em;
    }
    
    .sys-badge {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 6px 10px;
      background: rgba(34, 211, 238, 0.08);
      border: 1px solid rgba(34, 211, 238, 0.2);
      border-radius: 8px;
      animation: float 3s ease-in-out infinite;
    }
    
    .sys-badge-text {
      font-size: 9px;
      font-weight: 700;
      color: var(--cyan);
      text-transform: uppercase;
      letter-spacing: 0.1em;
    }
    
    /* ========== HERO MISSION CARD ========== */
    .hero-mission {
      margin: 0 16px 16px;
      border-radius: 24px;
      overflow: hidden;
      position: relative;
      cursor: pointer;
      opacity: 0;
      animation: slideUp 0.6s cubic-bezier(0.16, 1, 0.3, 1) 0.1s forwards;
    }
    
    .hero-mission:active { transform: scale(0.98); }
    
    .hero-mission-bg {
      position: absolute;
      inset: 0;
      background: url('https://images.unsplash.com/photo-1534438327276-14e5300c3a48?w=800&q=80') center/cover;
      opacity: 0.35;
      filter: grayscale(20%) brightness(0.9);
      transition: all 0.5s ease;
    }
    
    .hero-mission:hover .hero-mission-bg { opacity: 0.45; transform: scale(1.02); }
    
    .hero-mission-gradient {
      position: absolute;
      inset: 0;
      background: linear-gradient(180deg, rgba(2,4,8,0.3) 0%, rgba(2,4,8,0.8) 100%);
    }
    
    .hero-mission-content {
      position: relative;
      z-index: 2;
      padding: 20px;
      min-height: 260px;
      display: flex;
      flex-direction: column;
    }
    
    .hero-top {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
    }
    
    .priority-badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 5px 10px;
      background: rgba(0,0,0,0.6);
      border: 1px solid rgba(245, 158, 11, 0.4);
      border-radius: 16px;
    }
    
    .priority-dot {
      width: 6px;
      height: 6px;
      background: #f59e0b;
      border-radius: 50%;
      box-shadow: 0 0 8px #f59e0b;
      animation: subtlePulse 1.5s ease-in-out infinite;
    }
    
    .priority-text {
      font-size: 9px;
      font-weight: 700;
      color: #fbbf24;
      text-transform: uppercase;
      letter-spacing: 0.08em;
    }
    
    .settings-btn {
      width: 36px;
      height: 36px;
      background: rgba(255,255,255,0.08);
      border: 1px solid rgba(255,255,255,0.15);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
    }
    
    .settings-btn:active {
      background: rgba(34, 211, 238, 0.2);
      border-color: var(--cyan);
    }
    
    .hero-center {
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: center;
      padding: 16px 0;
    }
    
    .hero-day {
      font-family: 'Chakra Petch', sans-serif;
      font-size: 38px;
      font-weight: 900;
      color: #fff;
      text-transform: uppercase;
      letter-spacing: 2px;
      text-shadow: 0 4px 20px rgba(0,0,0,0.5);
      line-height: 1;
    }
    
    .hero-workout-row {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-top: 8px;
    }
    
    .hero-workout-bar {
      width: 3px;
      height: 18px;
      background: var(--cyan);
      border-radius: 2px;
      box-shadow: 0 0 10px var(--cyan);
    }
    
    .hero-workout-name {
      font-size: 13px;
      font-weight: 600;
      color: var(--cyan);
      text-transform: uppercase;
      letter-spacing: 0.1em;
    }
    
    .hero-technique {
      display: inline-flex;
      margin-top: 12px;
      padding: 4px 10px;
      background: rgba(0,0,0,0.5);
      border: 1px solid rgba(34, 211, 238, 0.3);
      border-radius: 6px;
      font-size: 10px;
      font-weight: 700;
      color: var(--cyan);
      text-transform: uppercase;
      letter-spacing: 0.08em;
      width: fit-content;
    }
    
    /* ========== HERO METRICS ========== */
    .hero-metrics {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 8px;
    }
    
    .hero-metric {
      background: rgba(15, 23, 42, 0.85);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border: 1px solid rgba(255,255,255,0.08);
      border-radius: 14px;
      padding: 12px 8px;
      text-align: center;
      transition: all 0.3s ease;
    }
    
    .hero-metric:hover {
      border-color: rgba(34, 211, 238, 0.3);
      background: rgba(15, 23, 42, 0.95);
    }
    
    .metric-icon {
      color: var(--cyan);
      margin-bottom: 4px;
      filter: drop-shadow(0 0 4px rgba(34, 211, 238, 0.4));
    }
    
    .metric-value {
      font-family: 'Chakra Petch', sans-serif;
      font-size: 18px;
      font-weight: 800;
      color: #fff;
    }
    
    .metric-label {
      font-size: 8px;
      font-weight: 600;
      color: #64748b;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      margin-top: 2px;
    }
    
    .metric-rpe {
      color: #ec4899;
    }
    
    .metric-xp {
      color: #22c55e;
      text-shadow: 0 0 8px rgba(34, 197, 94, 0.4);
    }
    
    /* ========== ANALYTICS GRID ========== */
    .analytics-section {
      padding: 0 16px 16px;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      opacity: 0;
      animation: slideUp 0.6s cubic-bezier(0.16, 1, 0.3, 1) 0.2s forwards;
    }
    
    .analytics-card {
      background: rgba(255,255,255,0.02);
      border: 1px solid rgba(255,255,255,0.06);
      border-radius: 18px;
      padding: 16px;
      position: relative;
      overflow: hidden;
      transition: all 0.3s ease;
    }
    
    .analytics-card:hover {
      border-color: rgba(34, 211, 238, 0.2);
      background: rgba(255,255,255,0.03);
    }
    
    .analytics-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 1px;
      background: linear-gradient(90deg, transparent, rgba(34,211,238,0.15), transparent);
    }
    
    .analytics-label {
      font-size: 9px;
      font-weight: 700;
      color: #64748b;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      margin-bottom: 6px;
    }
    
    .analytics-value {
      font-family: 'Chakra Petch', sans-serif;
      font-size: 28px;
      font-weight: 900;
      color: #fff;
    }
    
    .analytics-unit {
      font-size: 12px;
      font-weight: 600;
      color: #64748b;
    }
    
    .analytics-change {
      display: flex;
      align-items: center;
      gap: 4px;
      margin-top: 6px;
      font-size: 10px;
      font-weight: 600;
      color: #22c55e;
    }
    
    .analytics-icon {
      position: absolute;
      right: 14px;
      top: 50%;
      transform: translateY(-50%);
      color: #334155;
    }
    
    .analytics-bar {
      margin-top: 10px;
      height: 3px;
      background: rgba(255,255,255,0.06);
      border-radius: 2px;
      overflow: hidden;
    }
    
    .analytics-bar-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--cyan), #22c55e);
      border-radius: 2px;
      animation: shimmer 2s linear infinite;
      background-size: 200% 100%;
    }
    
    /* ========== OTHER MISSIONS ========== */
    .missions-section {
      padding: 0 16px 100px;
    }
    
    .section-header {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 12px;
    }
    
    .section-bar {
      width: 3px;
      height: 12px;
      background: var(--cyan);
      border-radius: 2px;
    }
    
    .section-title {
      font-size: 10px;
      font-weight: 700;
      color: #64748b;
      text-transform: uppercase;
      letter-spacing: 0.12em;
    }
    
    .mission-card {
      display: flex;
      align-items: center;
      gap: 14px;
      padding: 14px;
      background: linear-gradient(135deg, rgba(255,255,255,0.03) 0%, rgba(255,255,255,0.01) 100%);
      border: 1px solid rgba(255,255,255,0.06);
      border-radius: 16px;
      margin-bottom: 10px;
      cursor: pointer;
      transition: all 0.3s ease;
      opacity: 0;
      animation: slideUp 0.5s cubic-bezier(0.16, 1, 0.3, 1) forwards;
    }
    
    .mission-card:nth-child(1) { animation-delay: 0.25s; }
    .mission-card:nth-child(2) { animation-delay: 0.3s; }
    .mission-card:nth-child(3) { animation-delay: 0.35s; }
    .mission-card:nth-child(4) { animation-delay: 0.4s; }
    
    .mission-card:active { transform: scale(0.98); }
    .mission-card:hover { border-color: rgba(255,255,255,0.12); background: rgba(255,255,255,0.04); }
    
    .mission-icon {
      width: 44px;
      height: 44px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
    }
    
    .mission-icon.cyan { background: rgba(34,211,238,0.12); border: 1px solid rgba(34,211,238,0.25); color: var(--cyan); }
    .mission-icon.pink { background: rgba(236,72,153,0.12); border: 1px solid rgba(236,72,153,0.25); color: #ec4899; }
    .mission-icon.purple { background: rgba(168,85,247,0.12); border: 1px solid rgba(168,85,247,0.25); color: #a855f7; }
    .mission-icon.amber { background: rgba(245,158,11,0.12); border: 1px solid rgba(245,158,11,0.25); color: #f59e0b; }
    
    .mission-content { flex: 1; min-width: 0; }
    
    .mission-top {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 4px;
    }
    
    .mission-technique {
      font-size: 9px;
      font-weight: 700;
      color: var(--cyan);
      text-transform: uppercase;
      padding: 2px 6px;
      background: rgba(34,211,238,0.1);
      border: 1px solid rgba(34,211,238,0.2);
      border-radius: 4px;
    }
    
    .mission-day {
      font-size: 9px;
      font-weight: 600;
      color: #64748b;
      text-transform: uppercase;
    }
    
    .mission-name {
      font-family: 'Chakra Petch', sans-serif;
      font-size: 15px;
      font-weight: 800;
      color: #fff;
      text-transform: uppercase;
    }
    
    .mission-stats {
      display: flex;
      gap: 12px;
      margin-top: 8px;
    }
    
    .mission-stat {
      display: flex;
      flex-direction: column;
    }
    
    .mission-stat-label {
      font-size: 8px;
      font-weight: 600;
      color: #475569;
      text-transform: uppercase;
    }
    
    .mission-stat-value {
      font-family: 'Chakra Petch', sans-serif;
      font-size: 13px;
      font-weight: 700;
      color: #e2e8f0;
    }
    
    .mission-rpe {
      margin-left: auto;
      text-align: right;
    }
    
    .mission-rpe-value {
      font-family: 'Chakra Petch', sans-serif;
      font-size: 16px;
      font-weight: 800;
      color: #ec4899;
    }
    
    .mission-rpe-label {
      font-size: 8px;
      font-weight: 600;
      color: #475569;
      text-transform: uppercase;
    }
    
    .mission-eye {
      width: 36px;
      height: 36px;
      background: rgba(34,211,238,0.1);
      border: 1px solid rgba(34,211,238,0.2);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--cyan);
      flex-shrink: 0;
      transition: all 0.3s ease;
    }
    
    .mission-card:hover .mission-eye {
      background: rgba(34,211,238,0.2);
      box-shadow: 0 0 15px rgba(34,211,238,0.3);
    }
  </style>
</head>

<body>
  <div class="grain-overlay"></div>
  
  <!-- HEADER -->
  <div class="header-bar">
    <div>
      <h1 class="font-hud text-lg font-black text-white tracking-wider">OPÉRATIONS</h1>
      <div class="net-status">
        <div class="net-dot"></div>
        <span class="text-[9px] font-bold text-green-400 uppercase tracking-widest">NET_LINK_ACTIVE</span>
      </div>
    </div>
    <button onclick="window.location.href='index.html'" class="w-9 h-9 rounded-full bg-amber-500/10 border border-amber-500/20 flex items-center justify-center">
      <i data-lucide="trophy" class="w-4 h-4 text-amber-400"></i>
    </button>
  </div>
  
  <!-- TIMELINE -->
  <div class="timeline-scroll" id="timeline">
    <div class="week-chip active"><span class="week-label">SEM</span><span class="week-num">1</span></div>
    <div class="week-chip"><span class="week-label">SEM</span><span class="week-num">2</span></div>
    <div class="week-chip"><span class="week-label">SEM</span><span class="week-num">3</span></div>
    <div class="week-chip"><span class="week-label">SEM</span><span class="week-num">4</span></div>
    <div class="week-chip"><span class="week-label">SEM</span><span class="week-num">5</span></div>
    <div class="week-chip deload"><span class="week-label">DELOAD</span><span class="week-num">6</span></div>
  </div>
  
  <!-- BLOCK HEADER -->
  <div class="block-header">
    <div>
      <h2 class="block-title" id="block-name">FONDATIONS</h2>
      <div class="block-meta">
        <span class="block-meta-text" id="block-info">BLOC 1 • VOLUME & TECHNIQUE</span>
      </div>
    </div>
    <div class="sys-badge">
      <i data-lucide="cpu" class="w-3.5 h-3.5 text-cyan-400"></i>
      <span class="sys-badge-text">SYS.READY</span>
    </div>
  </div>
  
  <!-- HERO MISSION -->
  <div class="hero-mission" id="hero-mission">
    <div class="hero-mission-bg"></div>
    <div class="hero-mission-gradient"></div>
    <div class="hero-mission-content">
      <div class="hero-top">
        <div class="priority-badge">
          <div class="priority-dot"></div>
          <span class="priority-text">Priorité Alpha</span>
        </div>
        <button class="settings-btn" id="hero-next-btn">
          <i data-lucide="settings" class="w-4 h-4 text-white/70"></i>
        </button>
      </div>
      
      <div class="hero-center">
        <h3 class="hero-day" id="hero-day">DIMANCHE</h3>
        <div class="hero-workout-row">
          <div class="hero-workout-bar"></div>
          <span class="hero-workout-name" id="hero-workout">DOS + JAMBES</span>
        </div>
        <div class="hero-technique" id="hero-technique">TEMPO 3-1-2</div>
      </div>
      
      <div class="hero-metrics">
        <div class="hero-metric">
          <i data-lucide="clock" class="w-4 h-4 metric-icon"></i>
          <div class="metric-value" id="hero-duration">68m</div>
          <div class="metric-label">Durée</div>
        </div>
        <div class="hero-metric">
          <i data-lucide="layers" class="w-4 h-4 metric-icon"></i>
          <div class="metric-value" id="hero-sets">31</div>
          <div class="metric-label">Séries</div>
        </div>
        <div class="hero-metric">
          <i data-lucide="gauge" class="w-4 h-4 metric-icon" style="color: #ec4899;"></i>
          <div class="metric-value metric-rpe" id="hero-rpe">6-7</div>
          <div class="metric-label">RPE</div>
        </div>
        <div class="hero-metric">
          <i data-lucide="zap" class="w-4 h-4 metric-icon" style="color: #22c55e;"></i>
          <div class="metric-value metric-xp" id="hero-xp">+620</div>
          <div class="metric-label">XP</div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- ANALYTICS -->
  <div class="analytics-section">
    <div class="analytics-card">
      <div class="analytics-label">Meilleur Perf</div>
      <div>
        <span class="analytics-value" id="best-perf">140</span>
        <span class="analytics-unit">KG</span>
      </div>
      <div class="analytics-change">
        <i data-lucide="trending-up" class="w-3 h-3"></i>
        <span>+2.5% vs Sem 3</span>
      </div>
      <div class="analytics-icon">
        <i data-lucide="trophy" class="w-5 h-5"></i>
      </div>
    </div>
    
    <div class="analytics-card">
      <div class="analytics-label">Volume Hebdo</div>
      <div>
        <span class="analytics-value" id="weekly-volume">42</span>
        <span class="analytics-unit">T</span>
      </div>
      <div class="analytics-bar">
        <div class="analytics-bar-fill" style="width: 75%;"></div>
      </div>
      <div class="analytics-icon">
        <span class="font-hud text-xl font-black">#</span>
      </div>
    </div>
  </div>
  
  <!-- OTHER MISSIONS -->
  <div class="missions-section">
    <div class="section-header">
      <div class="section-bar"></div>
      <span class="section-title">Autres Missions</span>
    </div>
    <div id="other-missions"></div>
  </div>

  <script>
    let currentWeek = 1;
    let currentDayIndex = 0;
    const days = ['dimanche', 'mardi', 'vendredi', 'maison'];
    const dayLabels = { 'dimanche': 'DIMANCHE', 'mardi': 'MARDI', 'vendredi': 'VENDREDI', 'maison': 'MAISON' };
    const dayIcons = { 'dimanche': 'zap', 'mardi': 'dumbbell', 'vendredi': 'activity', 'maison': 'home' };
    const dayColors = { 'dimanche': 'cyan', 'mardi': 'pink', 'vendredi': 'purple', 'maison': 'amber' };
    
    function initIcons() {
      if (typeof lucide !== 'undefined') lucide.createIcons();
    }
    
    function init() {
      currentWeek = parseInt(localStorage.getItem('hybrid_current_week') || '1');
      initIcons();
      renderTimeline();
      renderContent(currentWeek);
      
      document.getElementById('hero-mission').onclick = (e) => {
        if (e.target.closest('.settings-btn')) return;
        const day = days[currentDayIndex];
        window.location.href = `briefing.html?week=${currentWeek}&day=${day}`;
      };
      
      document.getElementById('hero-next-btn').onclick = (e) => {
        e.stopPropagation();
        currentDayIndex = (currentDayIndex + 1) % days.length;
        updateHeroCard(currentWeek);
      };
    }
    
    function renderTimeline() {
      const container = document.getElementById('timeline');
      container.innerHTML = '';
      
      for (let i = 1; i <= 26; i++) {
        const weekData = programData.getWeek(i);
        const isDeload = weekData.isDeload;
        const isPeak = i === 25;
        
        let extraClass = '';
        if (isDeload) extraClass = 'deload';
        if (isPeak) extraClass = 'peak';
        
        const chip = document.createElement('div');
        chip.className = `week-chip ${i === currentWeek ? 'active' : ''} ${extraClass}`;
        
        chip.onclick = () => {
          document.querySelectorAll('.week-chip').forEach(c => c.classList.remove('active'));
          chip.classList.add('active');
          currentWeek = i;
          localStorage.setItem('hybrid_current_week', i);
          currentDayIndex = 0;
          renderContent(i);
        };
        
        const label = isDeload ? 'DELOAD' : (isPeak ? 'PEAK' : 'SEM');
        chip.innerHTML = `<span class="week-label">${label}</span><span class="week-num">${i}</span>`;
        container.appendChild(chip);
      }
      
      setTimeout(() => {
        const active = container.querySelector('.active');
        if (active) active.scrollIntoView({ behavior: 'smooth', inline: 'center', block: 'nearest' });
      }, 300);
    }
    
    function renderContent(week) {
      const weekData = programData.getWeek(week);
      const blockName = programData.info.blockTechniques[`block${weekData.block}`]?.name || "FONDATIONS";
      document.getElementById('block-name').textContent = blockName.toUpperCase();
      document.getElementById('block-info').textContent = `BLOC ${weekData.block} • ${weekData.technique}`;
      
      updateHeroCard(week);
      renderOtherMissions(week);
      initIcons();
    }
    
    function updateHeroCard(week) {
      const weekData = programData.getWeek(week);
      const day = days[currentDayIndex];
      const workout = weekData[day];
      
      if (!workout) {
        currentDayIndex = 0;
        updateHeroCard(week);
        return;
      }
      
      document.getElementById('hero-day').textContent = dayLabels[day];
      document.getElementById('hero-workout').textContent = workout.name;
      document.getElementById('hero-technique').textContent = weekData.technique.split('+')[0];
      document.getElementById('hero-duration').textContent = workout.duration + 'm';
      document.getElementById('hero-sets').textContent = workout.totalSets;
      document.getElementById('hero-rpe').textContent = weekData.rpeTarget;
      document.getElementById('hero-xp').textContent = '+' + (workout.totalSets * 20);
      
      initIcons();
    }
    
    function renderOtherMissions(week) {
      const container = document.getElementById('other-missions');
      container.innerHTML = '';
      const weekData = programData.getWeek(week);
      
      days.forEach((day, index) => {
        if (index === currentDayIndex) return;
        
        const workout = weekData[day];
        if (!workout) return;
        
        const card = document.createElement('div');
        card.className = 'mission-card';
        card.onclick = () => window.location.href = `briefing.html?week=${week}&day=${day}`;
        
        card.innerHTML = `
          <div class="mission-icon ${dayColors[day]}">
            <i data-lucide="${dayIcons[day]}" class="w-5 h-5"></i>
          </div>
          <div class="mission-content">
            <div class="mission-top">
              <span class="mission-technique">${weekData.technique.split('+')[0]}</span>
              <span class="mission-day">${dayLabels[day]}</span>
            </div>
            <div class="mission-name">${workout.name}</div>
            <div class="mission-stats">
              <div class="mission-stat">
                <span class="mission-stat-label">Durée</span>
                <span class="mission-stat-value">${workout.duration}m</span>
              </div>
              <div class="mission-stat">
                <span class="mission-stat-label">Séries</span>
                <span class="mission-stat-value">${workout.totalSets}</span>
              </div>
            </div>
          </div>
          <div class="mission-rpe">
            <div class="mission-rpe-value">${weekData.rpeTarget}</div>
            <div class="mission-rpe-label">RPE</div>
          </div>
          <div class="mission-eye">
            <i data-lucide="eye" class="w-4 h-4"></i>
          </div>
        `;
        
        container.appendChild(card);
      });
      
      initIcons();
    }
    
    function waitForData() {
      if (typeof programData !== 'undefined' && programData.getWeek) {
        init();
      } else {
        setTimeout(waitForData, 50);
      }
    }
    
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', waitForData);
    } else {
      waitForData();
    }
  </script>
</body>
</html>
